{"version":3,"file":"option.js","sourceRoot":"","sources":["option.ts"],"names":["Option","Option.constructor","Option.name","Option.is","Option.parse"],"mappings":"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CAACA,CAACA,CAACA;YACvBA,EAAEA,CAACA,CAACA,IAAIA,IAAIA,IAAIA,IAAIA,CAACA,IAAIA,CAACA,IAAIA,CAACA,IAAIA,CAACA,CAACA,CAACA,CAACA;gBACnCA,IAAIA,CAACA,YAAYA,CAACA,GAAGA,IAAIA,CAACA,YAAYA,CAACA,IAAIA,EAAEA,CAACA;gBAC9CA,IAAIA,CAACA,YAAYA,CAACA,CAACA,IAAIA,CAACA,IAAIA,CAACA,CAACA;gBAC9BA,MAAMA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA;YACzBA,CAACA;YAACA,IAAIA,CAACA,CAACA;gBACJA,IAAIA,CAACA,YAAYA,CAACA,GAAGA,IAAIA,CAACA,YAAYA,CAACA,IAAIA,EAAEA,CAACA;gBAC9CA,IAAIA,CAACA,YAAYA,CAACA,CAACA,IAAIA,CAACA,IAAIA,CAACA,YAAYA,CAACA,CAACA;gBAC3CA,MAAMA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA;YACzBA,CAACA;QACLA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACJA,IAAIA,CAACA,YAAYA,CAACA,GAAGA,IAAIA,CAACA,EAAEA,GAAGA,IAAIA,GAAGA,KAAKA,CAACA;YAC5CA,MAAMA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA;QACzBA,CAACA;IACLA,CAACA;IACLJ,aAACA;AAADA,CAACA,AAhHD,IAgHC;AAhHD;wBAgHC,CAAA","sourcesContent":["\"use strict\";\n\nimport * as utils from \"./utils\";\n\n// jsdoc, see constructor.\nexport default class Option {\n    /** this option need parameter value. it is required. */\n    required: boolean;\n    /** this option need parameter value. it is optional. */\n    optional: boolean;\n    /** this option is default true. if specified this option, value is become false. */\n    no: boolean;\n    /** short style. e.g. -o */\n    short: string;\n    /** long style. e.g. --option */\n    long: string;\n    /** description of this option */\n    description: string;\n\n    /**\n     * class of option.\n     * ```\n     * cmd --path foo/bar buzz.txt\n     *       â†‘ this one!\n     * ```\n     * @param flags pass '-f, --foo'(boolean) or '--foo'(boolean) or '--foo <bar>'(string[]) or '--foo [bar]'(string[]).\n     * @param description\n     * @param defaultValue\n     * @class\n     */\n    constructor(public flags: string, description?: string, public defaultValue?: any) {\n        this.required = flags.indexOf(\"<\") !== -1;\n        this.optional = flags.indexOf(\"[\") !== -1;\n        this.no = flags.indexOf(\"-no-\") === -1;\n        var splittedFlags = flags.split(/[ ,|]+/);\n        if (splittedFlags.length > 1 && !/^[[<]/.test(splittedFlags[1])) {\n            this.short = splittedFlags.shift();\n        }\n        this.long = splittedFlags.shift();\n        this.description = description || '';\n        if (typeof this.defaultValue === \"undefined\") {\n            if (this.required || this.optional) {\n                this.defaultValue = \"\";\n            } else {\n                this.defaultValue = !this.no;\n            }\n        }\n    }\n\n    /**\n     * name of this option.\n     * @returns {any}\n     */\n    name() {\n        return this.long.replace(\"--\", \"\").replace(\"no-\", \"\");\n    }\n\n    /**\n     * check arg is matches this option.\n     * @param arg\n     * @returns {boolean}\n     */\n    is(arg: string) {\n        return arg === this.short || arg === this.long;\n    }\n\n    /**\n     * parse args.\n     * build to opts.\n     *\n     * e.g. #1\n     *   instance member:  required=true, optional=false, short=-f, long=--foo\n     *   method arguments: opts={}, args=[\"--foo\", \"foo!\", \"bar!\"].\n     *   opts are modified to { foo: [\"foo!\"] } and return [\"bar!\"].\n     *\n     * e.g. #2\n     *   instance member:  required=true, optional=false, short=-f, long=--foo\n     *   method arguments: opts={ foo: [\"foo?\"] }, args=[\"--foo\", \"foo!\", \"bar!\"].\n     *   opts are modified to { foo: [\"foo?\", \"foo!\"] } and return [\"bar!\"].\n     *\n     * e.g. #3\n     *   instance member:  required=false, optional=false, short=-f, long=--foo\n     *   method arguments: opts={}, args=[\"-f\", \"foo!\", \"bar!\"].\n     *   opts are modified to { foo: true } and return [\"foo!\", \"bar!\"].\n     *\n     * @param opts\n     * @param args\n     * @returns {string[]}\n     */\n    parse(opts: any, args: string[]): string[] {\n        if (!this.is(args[0])) {\n            throw new Error(args[0] + \" is not match \" + this.short + \" or \" + this.long);\n        }\n        var next = args[1];\n        var propertyName = utils.chainToLowerCamelCase(this.name());\n        if (this.required) {\n            if (next == null) {\n                throw new Error(args[0] + \" is required parameter value\");\n            }\n            opts[propertyName] = opts[propertyName] || [];\n            opts[propertyName].push(next);\n            return args.slice(2);\n        } else if (this.optional) {\n            if (next != null && !/^-/.test(next)) {\n                opts[propertyName] = opts[propertyName] || [];\n                opts[propertyName].push(next);\n                return args.slice(2);\n            } else {\n                opts[propertyName] = opts[propertyName] || [];\n                opts[propertyName].push(this.defaultValue);\n                return args.slice(1);\n            }\n        } else {\n            opts[propertyName] = this.no ? true : false;\n            return args.slice(1);\n        }\n    }\n}\n"]}